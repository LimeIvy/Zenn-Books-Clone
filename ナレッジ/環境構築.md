# DockerでのMySQL環境構築

**Dockerの起動**

```bash
docker-compose up -d  
```

```bash
docker start <CONTAINER IDまたはNAME>
```

**Dockerの停止**
```bash
docker stop <CONTAINER IDまたはNAME>
```

**コンテナ内のMySQLサーバーに接続**

```bash
docker exec -it (mysql-container) sql
```

- -it: 対話的に操作するためのオプションです。
- (mysql-container): 接続するコンテナの名前です。
- sql: コンテナ内で実行するシェルコマンドです。

```bash
mysql -u root -p
```

- -u root: MySQLサーバーに接続する際のユーザー名を指定します。
- -p: パスワードを入力するプロンプトが表示されることを指定します。このオプションを指定すると、コマンドを実行した後にパスワード入力が求められます。

## **コマンド**

**データベース一覧を見る**
```sql
show databases;
```

**データベースを新しく作成する**
```sql
create database (db_name);
```

**データベースを選択する**
```sql
use (db_name);
```

**テーブルを作成する**
```sql
create table (table_name) (id ○○, name ○○);
```
`今回のテーブル`
```sql
create table books( 
  id VARBINARY(16), 
  title CHAR(150) NOT NULL, 
  auther CHAR(100) NOT NULL, 
  description VARCHAR(2000), 
  created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, 
  updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, 
  PRIMARY KEY (id) 
);

create table chapter(
   id VARBINARY(16), 
   books_id INT NOT NULL, 
   name CHAR(150) NOT NULL, 
   content TEXT, 
   created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP, 
   updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, 
   PRIMARY KEY (id), 
   FOREIGN KEY (books_id) REFERENCES books(id) 
);
```

**テーブル構造を表示する**
```sql
describe (table_name);
```

**カラム定義を変更する**
```sql
alter table (table_name) modify col_name column_definition;
```

`使用例`

```sql
alter table books modify title char(70) not null;
```

- tableを必須項目に修正

**カラムを追加**
```sql
alter table (table_name) add column (col_name) (data_type);
```
`使用例`

```sql
alter table (table_name) add column (col_name) (data_type);
```

**カラムを削除**
```sql
alter table (table_name) drop column (col_name);
```

**インデックスを作成**
```sql
create index (idx_name) on (table_name)((column_name));
```

**データを挿入**
```sql
insert into (table_name) (col_name,col_name) values
  ('value', value);
```

**uuidをbinery16に変換して格納**
```sql
 insert into (table_name) (id) values (UUID_TO_BIN('(uuid)'));
```

**文字列中の特定の文字を除去**
```sql
 replace(books_id, '-', '') as id
```